/*
Author: Anshu Krishna
Contact: anshu.krishna5@gmail.com
Date: 15-Sep-2019
*/

class JSCSS{constructor(...e){Object.defineProperties(this,{__styles:{enumerable:!1,writable:!1,value:{}},__childs:{enumerable:!1,writable:!1,value:{}},__styleElement:{enumerable:!1,writable:!1,value:document.createElement("style")},__spacer:{enumerable:!1,writable:!0,value:!0}}),Object.defineProperties(this,{spaceFromParentSelector:{enumerable:!0,set:e=>{this.__spacer=!!e},get:()=>this.__spacer},selectors:{enumerable:!1,writable:!1,value:new JSCSS.__StringSet},styleElement:{enumerable:!0,get:e=>{let t=this.__styleElement.innerHTML,r=String(this);return t!==r&&(this.__styleElement.innerHTML=this),this.__styleElement}},style:{enumerable:!0,writable:!1,value:new Proxy(this.__styles,{get:Reflect.get,set:(e,t,r)=>{Array.isArray(r)?e[t]=r:"object"==typeof r?console.error("Invalid style value"):e[t]=r}})},child:{enumerable:!0,writable:!1,value:new Proxy(this.__childs,{get:Reflect.get,set:(e,t,r)=>{r instanceof JSCSS?e[t]=r:console.error("Invalid child value. It must be an instance of JSCSS")}})},__stylesToString:{enumerable:!1,get:()=>{const e=[];for(let t in this.__styles)if(Array.isArray(this.__styles[t]))for(let r of this.__styles[t])e.push(JSCSS.__styleFormat(t,r));else e.push(JSCSS.__styleFormat(t,this.__styles[t]));return e.join("\n")}},__selectorsToString:{enumerable:!1,writable:!1,value:(e=null)=>{if(null===e)return Array.from(this.selectors).join(",\n");Array.isArray(e)||(e=[e]);let t=Array.from(this.selectors),r=[];for(let s of e)for(let e of t)r.push(this.__spacer?`${s} ${e}`:`${s}${e}`);return r.join(",\n")}},__stringify:{enumerable:!1,writable:!1,value:(e=null)=>{let t=[],r=Array.from(this.selectors);if(0!==r.length){let r=this.__stylesToString;0!==r.length&&t.push(`${this.__selectorsToString(e)} {\n${this.__stylesToString}\n}`)}let s=[];if(null===e)s=r;else for(let t of e)for(let e of r)s.push(`${t} ${e}`);for(let e in this.__childs)t.push(`${this.__childs[e].__stringify(s)}`);return t.join("\n\n")}}});for(let t of e)this.selectors.add(t)}toString(){return this.__stringify()}reRender(){return this.styleElement.innerHTML=this,this}addStyles(...e){for(let t of e){if("object"!=typeof t)return void console.error("addStyles expects an object as parameter");for(let e of Object.keys(t))Reflect.set(this.style,e,t[e])}return this}deleteStyles(){let e=Object.keys(this.__styles);for(let t of e)delete this.__styles[t]}copyStylesFrom(e){e instanceof JSCSS?(this.deleteStyles(),this.addStyles(e.__styles)):console.error(" expects parater to be an instance of JSCSS")}mergeStylesFrom(e){e instanceof JSCSS?this.addStyles(e.__styles):console.error(" expects parater to be an instance of JSCSS")}unlinkFromDOM(){let e=this.__styleElement.parentNode;null!==e&&e.removeChild(this.__styleElement)}}Object.defineProperties(JSCSS,{__trimmedString:{enumerable:!1,writable:!1,value:e=>String(e).trim()},__styleFormat:{enumerable:!1,writable:!1,value:(e,t)=>`\t${e}: ${JSCSS.__trimmedString(t)};`},__StringSet:{enumerable:!1,writable:!1,value:class extends Set{add(e){super.add(JSCSS.__trimmedString(e))}delete(e){super.delete(JSCSS.__trimmedString(e))}has(e){super.has(JSCSS.__trimmedString(e))}}}});